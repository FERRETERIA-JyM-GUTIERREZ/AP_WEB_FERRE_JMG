[phases.setup]
nixPkgs = ["php82"]

[phases.install]
cmds = [
  "cd jm-ferreteria-backend",
  "curl -sS https://getcomposer.org/installer | php",
  "php composer.phar install --no-dev --optimize-autoloader"
]

[phases.build]
cmds = [
  "cd jm-ferreteria-backend && php composer.phar exec -- php artisan config:cache",
  "cd jm-ferreteria-backend && php composer.phar exec -- php artisan route:cache",
  "cd jm-ferreteria-backend && php composer.phar exec -- php artisan view:cache"
]

[start]
cmd = "cd jm-ferreteria-backend && php composer.phar exec -- php artisan migrate --force && php -S 0.0.0.0:$PORT -t public"

