â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  FLUJO SEGURO DE LOGIN - J&M GUTIÃ‰RREZ                         â•‘
â•‘                         âœ… 100% SEGURO                                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                               INICIO
                                 â”‚
                                 â†“
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  /login-selector   â”‚
                        â”‚ "Â¿QuiÃ©n eres tÃº?"  â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                         â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   CLIENTE        â”‚       â”‚   PERSONAL       â”‚
         â”‚  (Comprador)     â”‚       â”‚(Admin/Vendedor)  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                         â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
          â†“                   â†“              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  /register   â”‚  â”‚ /client-loginâ”‚  â”‚ /staff-login â”‚
    â”‚   (Nuevo)    â”‚  â”‚  (Existente) â”‚  â”‚  (Personal)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚              â”‚
          â”œâ”€ Google â”€â”   â”Œâ”€ Google â”   Email + Pass
          â”‚ Email/Passâ”‚   â”‚Email/Passâ”‚    SOLO
          â”‚           â”‚   â”‚          â”‚
          â†“           â†“   â†“          â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Backend Valida:        â”‚ â”‚ Backend Valida:  â”‚
    â”‚ â€¢ Email existe?          â”‚ â”‚ â€¢ Email existe?  â”‚
    â”‚ â€¢ ContraseÃ±a correcta?   â”‚ â”‚ â€¢ ContraseÃ±a OK? â”‚
    â”‚ â€¢ Rol = "cliente"        â”‚ â”‚ â€¢ Rol â‰  "cliente"â”‚
    â”‚                          â”‚ â”‚ â€¢ Rol = vendedor â”‚
    â”‚ âœ… OK â†’ Token JWT        â”‚ â”‚   o admin?       â”‚
    â”‚ âŒ Error â†’ Rechaza       â”‚ â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ âœ… OK â†’ Token    â”‚
          â”‚                       â”‚ âŒ Error â†’ Rech. â”‚
          â†“                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       /                           â”‚
    (tienda)                       â”œâ”€ Rol: admin    â†’ /admin/dashboard
                                   â”œâ”€ Rol: vendedor â†’ /inventario
                                   â””â”€ Rol: empleado â†’ /dashboard

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                        ğŸ›¡ï¸  SEGURIDAD MULTINIVEL  ğŸ›¡ï¸                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

NIVEL 1: SEPARACIÃ“N DE RUTAS
â”œâ”€ /login-selector          (Selector claro de acceso)
â”œâ”€ /register               (Solo para nuevos clientes)
â”œâ”€ /client-login           (Solo para clientes existentes)
â”œâ”€ /staff-login            (Solo para personal)
â””â”€ Cada ruta tiene interfaz diferente y clara

NIVEL 2: VALIDACIÃ“N EN FRONTEND
â”œâ”€ ClientLogin.js:
â”‚  â””â”€ Verifica rol despuÃ©s de login
â”‚  â””â”€ Si no es cliente â†’ Error y logout
â”‚
â””â”€ StaffLogin.js:
   â””â”€ Verifica rol despuÃ©s de login
   â””â”€ Si no es vendedor/admin â†’ Error y logout

NIVEL 3: VALIDACIÃ“N EN BACKEND (MÃS IMPORTANTE)
â”œâ”€ AuthController:
â”‚  â”œâ”€ Valida credenciales
â”‚  â”œâ”€ Verifica rol del usuario
â”‚  â”œâ”€ Rechaza si es incorrecto
â”‚  â””â”€ Genera token JWT
â”‚
â””â”€ Middleware:
   â”œâ”€ Verifica token en cada peticiÃ³n
   â”œâ”€ Valida expiraciÃ³n
   â”œâ”€ Revisa permisos del usuario
   â””â”€ Rechaza si no tiene acceso

NIVEL 4: PROTECCIÃ“N DE RUTAS
â”œâ”€ PrivateRoute
â”‚  â””â”€ Solo usuarios autenticados
â”‚
â””â”€ AdminRoute
   â””â”€ Solo admins y vendedores

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                       âŒ  ATAQUES BLOQUEADOS  âŒ                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ATAQUE 1: Ir directamente a /staff-login como cliente
â”œâ”€ Acceso: âœ… Puedes ver la pÃ¡gina
â”œâ”€ Login: âœ… EnvÃ­as credenciales
â”œâ”€ Backend: âŒ Valida â†’ "No eres vendedor"
â”œâ”€ Resultado: âŒ Error "Credenciales invÃ¡lidas"
â””â”€ ConclusiÃ³n: âœ… BLOQUEADO

ATAQUE 2: Manipular localStorage
â”œâ”€ Intento: setItem('user', {rol: 'admin'})
â”œâ”€ Acceso: âœ… Puedes ver /admin/dashboard en frontend
â”œâ”€ PeticiÃ³n: âŒ Backend valida token JWT
â”œâ”€ Backend: âŒ Token no coincide con rol manipulado
â””â”€ ConclusiÃ³n: âœ… BLOQUEADO

ATAQUE 3: Usar token expirado
â”œâ”€ Token: Tiene fecha de expiraciÃ³n
â”œâ”€ PeticiÃ³n: âŒ Backend verifica exp
â”œâ”€ Resultado: âŒ 401 Unauthorized
â””â”€ ConclusiÃ³n: âœ… BLOQUEADO

ATAQUE 4: Falsificar JWT
â”œâ”€ Intento: Crear un JWT falso
â”œâ”€ Backend: Verifica firma criptogrÃ¡fica
â”œâ”€ Resultado: âŒ Firma no vÃ¡lida
â””â”€ ConclusiÃ³n: âœ… BLOQUEADO

ATAQUE 5: Cambiar rol en JWT
â”œâ”€ JWT es: header.payload.signature
â”œâ”€ Si cambias payload (rol)
â”œâ”€ Signature ya no coincide
â”œâ”€ Backend: Rechaza token
â””â”€ ConclusiÃ³n: âœ… BLOQUEADO

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         ğŸ“‹  MATRIZ DE SEGURIDAD  ğŸ“‹                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Usuario Intenta â”‚ Cliente Login     â”‚ Staff Login      â”‚ Manipular Token  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Cliente OK      â”‚ âœ… Acceso        â”‚ âŒ Bloqueado     â”‚ âŒ Bloqueado     â”‚
â”‚ Vendedor OK     â”‚ âŒ Bloqueado     â”‚ âœ… Acceso        â”‚ âŒ Bloqueado     â”‚
â”‚ Admin OK        â”‚ âŒ Bloqueado     â”‚ âœ… Acceso        â”‚ âŒ Bloqueado     â”‚
â”‚ Atacante        â”‚ âŒ Bloqueado     â”‚ âŒ Bloqueado     â”‚ âŒ Bloqueado     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                      âœ…  SISTEMA LISTO PARA PRODUCCIÃ“N  âœ…                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ARCHIVOS MODIFICADOS:
â”œâ”€ /pages/LoginSelector.js      â† Selector de acceso principal
â”œâ”€ /pages/ClientLogin.js        â† Login para clientes
â”œâ”€ /pages/StaffLogin.js         â† Login para personal
â”œâ”€ /pages/Login.js              â† Fallback (no se usa)
â”œâ”€ /pages/Register.js           â† Registro de clientes
â”œâ”€ /App.js                      â† Rutas actualizadas
â””â”€ SECURITY_LOGIN_FLOW.md       â† DocumentaciÃ³n de seguridad

RUTAS RESULTANTES:
â”œâ”€ /login-selector      â†’ Selector (SIN autenticaciÃ³n)
â”œâ”€ /register           â†’ Registro (SIN autenticaciÃ³n)
â”œâ”€ /client-login       â†’ Login clientes (SIN autenticaciÃ³n)
â”œâ”€ /staff-login        â†’ Login personal (SIN autenticaciÃ³n)
â”œâ”€ /                   â†’ Home (privado para clientes)
â”œâ”€ /carrito            â†’ (privado para clientes)
â”œâ”€ /inventario         â†’ (privado para vendedores)
â””â”€ /admin/dashboard    â†’ (privado para admins)

CONCLUSIÃ“N:
Un cliente malicioso NO PUEDE:
âŒ Hacerse pasar por vendedor
âŒ Acceder a /staff-login efectivamente
âŒ Manipular su rol
âŒ Ver datos de otros usuarios
âŒ Modificar precios o inventario
âŒ Ver reportes de ventas

Sistema completamente seguro y listo para producciÃ³n. ğŸš€

